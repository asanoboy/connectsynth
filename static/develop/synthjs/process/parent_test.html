<!DOCTYPE html>
<html>
<head>
<title>synthjs Unit Tests</title>
<script src="../../closurelibrary/closure/goog/base.js"></script>
<script src="../../deps.js"></script>
<script>
    goog.require("goog.testing.jsunit");
    goog.require("goog.testing.AsyncTestCase");
    
    goog.require("synthjs.process.Child");
</script>
</head>
<body id="body">
<script>

var asyncTestCase = new goog.testing.AsyncTestCase.createAndInstall();
var childpath = "parent_test_child.html";
function setUp() {

}

function tearDown() {

}

function testIframe() {
    var loadD = synthjs.process.Child.loadIframeDeferred(childpath, document.getElementById('body'));

    var message = "hello world.", child;

    loadD.addCallback(function(c){
        child = c;
        assertTrue( child instanceof synthjs.process.Child );
        handler.listen(
            child,
            synthjs.process.EventType.MESSAGE,
            function(event){
                assertTrue( event.target == message );
                child.dispose();
                asyncTestCase.continueTesting();
            })
        child.postMessage(message);
    });
    var handler = new goog.events.EventHandler();

    asyncTestCase.waitForAsync();
    loadD.callback();


}

function _testWindow() {
    var loadD = synthjs.process.Child.loadWindowDeferred(childpath);

    var message = "hello world.", child;

    loadD.addCallback(function(c){
        child = c;
        assertTrue( child instanceof synthjs.process.Child );
        handler.listen(
            child,
            synthjs.process.EventType.MESSAGE,
            function(event){
                assertTrue( event.target == message );
                child.dispose();
                asyncTestCase.continueTesting();
            })
        child.postMessage(message);
    });
    var handler = new goog.events.EventHandler();

    asyncTestCase.waitForAsync();
    loadD.callback();


}



</script>
</body>
</html>

