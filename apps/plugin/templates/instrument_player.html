{% extends "app.html" %}

{% block cssfile %}
{{ block.super }}
<link rel="stylesheet" href="{{ STATIC_URL }}css/closure/tree.css">
<link rel="stylesheet" href="{{ STATIC_URL }}css/closure/menu.css">
<link rel="stylesheet" href="{{ STATIC_URL }}css/closure/menubar.css">
<link rel="stylesheet" href="{{ STATIC_URL }}css/closure/menubutton.css">
<link rel="stylesheet" href="{{ STATIC_URL }}css/closure/menuitem.css">
<link rel="stylesheet" href="{{ STATIC_URL }}css/closure/menuseparator.css">
<link rel="stylesheet" href="{{ STATIC_URL }}css/codemirror/codemirror.css">
<!--<link rel="stylesheet" href="{{ STATIC_URL }}css/codemirror/docs.css">-->

<link rel="stylesheet/less" type="text/css" href="{{ STATIC_URL }}less/app.less">
<link rel="stylesheet/less" type="text/css" href="{{ STATIC_URL }}less/sdk.less">
{% endblock %}

{% block scriptfile %}

<!--
<script src="{{ STATIC_URL }}js/extern/underscore-min.js" type="text/javascript"></script>
<script src="{{ STATIC_URL }}js/extern/codemirror/codemirror.js" type="text/javascript"></script>
<script src="{{ STATIC_URL }}js/extern/codemirror/javascript.js" type="text/javascript"></script>
-->
{% if 1 %}
<script src="{{ STATIC_URL }}develop/closure/goog/base.js" type="text/javascript"></script>
<script src="{{ STATIC_URL }}develop/deps.js" type="text/javascript"></script>
<script src="{{ STATIC_URL }}develop/synthjs/oscillatortestplayer.js" type="text/javascript"></script>
{% else %}
	{% if is_test %}
<script src="{{ STATIC_URL }}develop/optimized_instrument_test_player.js" type="text/javascript"></script>	
	{% else %}
<script src="{{ STATIC_URL }}develop/optimized_instrument_player.js" type="text/javascript"></script>	
	{% endif %}
{% endif %}


{% if is_test %}
<script type="text/javascript" src="{{ STATIC_URL }}/js/jquery.upload.js"></script>
<script type="text/javascript">
var app = new OscillatorTestPlayer(
	"application", 
	{
		"bootstrapJs": "{% url get_plugin_test code, 'main.js' %}",
		"publishUrl": "{% url publish_instrument code %}"
	});
//app.initOscillator();
(function($){
	$(function(){
		$("body").delegate("input.ajaxPublishFormButton", 
			"click", 
			function(){
				var $form = $("form.ajaxPublishForm");
				$("input[type='file']", $form).upload(
					$form.attr("action"),
					$form.serialize(),
					function(rs){
						if( rs.status == '1' ){
							alert("ok");
						}
						else {
							alert("ng");
						}
					},
					'json'
				)
				// $.ajax($form.attr("action"), 
						// {
							// type: $form.attr("method"),
							// data: $form.serialize()
						// })
					// .then(function(rt){
						// if( rt.status=='1' ){
							// alert("Success Publish!");
						// }
						// else {
							// alert("Fail Publish!");
						// }
					// },
					// function(err){
						// alert("Fail Publish!");
					// }
				// )
			}
		);	
});
})(jQuery);
</script>
{% else %}
<script type="text/javascript">
var app = new OscillatorPlayer(
	"application", 
	{
		"bootstrapJs": "{% url get_plugin code, 'main.js' %}",
	});
//app.initOscillator();
</script>
{% endif %}
{% endblock %}
